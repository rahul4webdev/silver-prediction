# ============================================================================
# ADD THIS TO YOUR EXISTING prediction.gahfaudio.in vhconf.conf
# Add these sections AFTER the existing extprocessor predi8898 section
# ============================================================================

# Next.js Frontend Proxy
extprocessor nextjs_frontend {
  type                    proxy
  address                 127.0.0.1:8024
  maxConns                100
  pcKeepAliveTimeout      60
  initTimeout             60
  retryTimeout            0
  respBuffer              0
}

# Proxy all requests to Next.js
context / {
  type                    proxy
  handler                 nextjs_frontend
  addDefaultCharset       off
}

# Static assets with caching
context /_next/static {
  type                    proxy
  handler                 nextjs_frontend
  addDefaultCharset       off
  extraHeaders            <<<END_HEADERS
Cache-Control: public, max-age=31536000, immutable
END_HEADERS
}

# ============================================================================
# ALSO UPDATE THE rewrite SECTION - Replace your existing rewrite block with:
# ============================================================================

rewrite  {
  enable                  1
  autoLoadHtaccess        1
  rules                   <<<END_RULES
# Enable rewrite engine
RewriteEngine On

# Proxy all requests to Next.js on port 3000
RewriteRule ^(.*)$ http://127.0.0.1:8024$1 [P,L]
END_RULES
}
